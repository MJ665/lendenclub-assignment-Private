from typing import List, Literal, Optional
from pydantic import BaseModel, Field

class Vulnerability(BaseModel):
    id: str = Field(description="The Vulnerability ID (e.g., CVE-2023-1234 or AWS-001)")
    severity: Literal["LOW", "MEDIUM", "HIGH", "CRITICAL"] = Field(description="Severity level of the vulnerability")
    risk_summary: str = Field(description="A concise summary of the security risk")
    real_world_impact: str = Field(description="Explanation of what could happen if exploited")
    affected_resource: str = Field(description="The identifier of the affected Terraform resource (e.g., aws_security_group.web_sg)")

class ScanResult(BaseModel):
    vulnerabilities: List[Vulnerability] = Field(description="List of identified vulnerabilities")
